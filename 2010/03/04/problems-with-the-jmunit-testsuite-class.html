<!DOCTYPE html>
<html class="skin-default" lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Problems with the JMUnit TestSuite class | Lea Hayes</title>
<meta property="og:title" content="Problems with the JMUnit TestSuite class" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I attempted to use the ‘JMUnit’ unit testing library that is shipped with NetBeans for the first time today. I created a couple of simple TestCase classes and a TestSuite that combines each of these. However, every time I attempted to load the test suite I was presented with the following exception:" />
<meta property="og:description" content="I attempted to use the ‘JMUnit’ unit testing library that is shipped with NetBeans for the first time today. I created a couple of simple TestCase classes and a TestSuite that combines each of these. However, every time I attempted to load the test suite I was presented with the following exception:" />
<link rel="canonical" href="/2010/03/04/problems-with-the-jmunit-testsuite-class.html" />
<meta property="og:url" content="/2010/03/04/problems-with-the-jmunit-testsuite-class.html" />
<meta property="og:site_name" content="Lea Hayes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-03-04T00:00:00+00:00" />
<script type="application/ld+json">
{"name":null,"description":"I attempted to use the ‘JMUnit’ unit testing library that is shipped with NetBeans for the first time today. I created a couple of simple TestCase classes and a TestSuite that combines each of these. However, every time I attempted to load the test suite I was presented with the following exception:","author":null,"@type":"BlogPosting","url":"/2010/03/04/problems-with-the-jmunit-testsuite-class.html","publisher":null,"image":null,"headline":"Problems with the JMUnit TestSuite class","dateModified":"2010-03-04T00:00:00+00:00","datePublished":"2010-03-04T00:00:00+00:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"/2010/03/04/problems-with-the-jmunit-testsuite-class.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/main.css">
    <link rel="alternate" type="application/rss+xml" title="Lea Hayes" href="/feed.xml">

    <link rel="image_src" href="/assets/img/social-badge.png"/>
    <link rel="apple-touch-icon-precomposed" href="/assets/img/iphone-icon.png"/>
    <meta property="og:image" content="/assets/img/social-badge.png"/>
    <meta property="og:title" content="Problems with the JMUnit TestSuite class"/>

    
  </head>
  <body>

    <header class="site-header" role="banner">
  <div class="site-header__wrap">
    <a class="site-badge" href="/">Lea Hayes</a>

    <nav class="site-nav">
  <ul class="site-nav__list">
  
    
    
    <li class="site-nav__item">
      <a class="site-nav__link" href="/about/">About</a>
    </li>
    
  
    
    
    <li class="site-nav__item">
      <a class="site-nav__link" href="/portfolio/">Portfolio</a>
    </li>
    
  
    
    
    <li class="site-nav__item">
      <a class="site-nav__link" href="/blog/index.html">Blog</a>
    </li>
    
  
  </ul>
</nav>

  </div>
</header>


    <main class="main-content" aria-label="Content">
      <div class="main-content__wrap">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <nav class="blog-nav">
  <h1 class="blog-nav__title">Blog Navigation</h1>
  <ul class="blog-nav__list blog-nav__list--primary">
    <li class="blog-nav__item"><a class="blog-nav__link" href="/blog/">Posts</a></li>
    <li class="blog-nav__item"><a class="blog-nav__link" href="/tags/">Tags</a></li>
  </ul>
  <ul class="blog-nav__list blog-nav__list--secondary">
    <li class="blog-nav__item blog-nav__item--rss"><a class="blog-nav__link" href="/feed.xml">RSS</a></li>
  </ul>
</nav>


  <header class="post__header">
    <h1 class="post__title" itemprop="name headline">Problems with the JMUnit TestSuite class</h1>
    <p class="post__meta">
      <time datetime="2010-03-04T00:00:00+00:00" itemprop="datePublished">
        
        Mar 4, 2010
      </time>
    </p>
  </header>

  <div class="post__content body-content" itemprop="articleBody">
    <p>I attempted to use the ‘JMUnit’ unit testing library that is shipped with NetBeans for the
first time today. I created a couple of simple <code class="highlighter-rouge">TestCase</code> classes and a <code class="highlighter-rouge">TestSuite</code> that
combines each of these. However, every time I attempted to load the test suite I was
presented with the following exception:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>result 0: first.AdderTest
java.lang.SecurityException: MIDlet not constructed by createMIDlet.
        at com.sun.midp.midlet.MIDletStateHandler.newMIDletPeer(), bci=24
        at javax.microedition.midlet.MIDlet.(), bci=9
        at jmunit.framework.cldc10.Assertion.(), bci=1
        at jmunit.framework.cldc10.Test.(), bci=1
        at jmunit.framework.cldc10.TestCase.(), bci=2
        at first.AdderTest.(), bci=4
        at java.lang.Class.newInstance(), bci=0
     &gt;  at jmunit.framework.cldc10.TestSuite.(), bci=57
        at java.lang.Class.newInstance(), bci=0
        at com.sun.midp.main.CldcMIDletLoader.newInstance(), bci=46
        at com.sun.midp.midlet.MIDletStateHandler.createMIDlet(), bci=66
        at com.sun.midp.midlet.MIDletStateHandler.createAndRegisterMIDlet(), bci=17
        at com.sun.midp.midlet.MIDletStateHandler.startSuite(), bci=27
        at com.sun.midp.main.AbstractMIDletSuiteLoader.startSuite(), bci=52
        at com.sun.midp.main.CldcMIDletSuiteLoader.startSuite(), bci=8
        at com.sun.midp.main.AbstractMIDletSuiteLoader.runMIDletSuite(), bci=161
        at com.sun.midp.main.AppIsolateMIDletSuiteLoader.main(), bci=26
</code></pre></div></div>

<p>The above exception indicates that the problem originated from the constructor of my test
case class.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// AdderTest.java</span>
 
<span class="kn">import</span> <span class="nn">jmunit.framework.cldc10.*</span><span class="o">;</span>
 
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AdderTest</span> <span class="kd">extends</span> <span class="n">TestCase</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">AdderTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// This is where the problem occurs!</span>
        <span class="kd">super</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"AdderTest"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="kt">int</span> <span class="n">testNumber</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
        <span class="c1">// Note: 'testNumber' doesn't matter as there is only one test!</span>
        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Adder</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"1 + 2 = "</span> <span class="o">+</span> <span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Adder.java</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Adder</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>As you can see from the above source the constructor in question was extremely simple. The
exception was being generated as a result of instantiating the <code class="highlighter-rouge">AdderTest</code> class.
Surprisingly no such exceptions were being shown when test suites were not being used.</p>

<p>After some digging I discovered that this problem is in fact due to a security constraint
that is imposed by the J2ME specification. A MIDlet cannot attempt to create another
MIDlet from its constructor (See: <a href="http://sites.google.com/site/franciscobenitezleon/projects/jmunit-revised">http://sites.google.com/site/franciscobenitezleon/projects/jmunit-revised</a>).</p>

<p>Thankfully Francisco Benítez León has come up with a solution to this problem by providing
several customizations that allow us to workaround this problem. The various driver
classes are no longer derived from a MIDlet, and thus avoid the security exception. This
does, however, mean that we must create a simple MIDlet that kick-starts the testing
process.</p>

<p>Refer to the following link for a download of this library patch and for further information:
<a href="http://sites.google.com/site/franciscobenitezleon/projects/jmunit-revised/jmunit-revised-2-0">http://sites.google.com/site/franciscobenitezleon/projects/jmunit-revised/jmunit-revised-2-0</a></p>

  </div>

  
</article>

<nav class="post-meta-tags">
  <h1 class="post-meta-tags__title">Tags:</h1>
  <ul class="post-meta-tags__list">
  
  
    <li class="post-meta-tags__item"><a class="post-meta-tags__link" href="/tag/j2me">j2me</a></li>
    <li class="post-meta-tags__item"><a class="post-meta-tags__link" href="/tag/java">java</a></li>
    <li class="post-meta-tags__item"><a class="post-meta-tags__link" href="/tag/unit-testing">unit-testing</a></li>
  </ul>
</nav>


      </div>
    </main>

    <footer class="site-footer">
  <div class="site-footer__wrap">
    <h1 class="site-footer__title">Lea Hayes</h1>

    <div class="site-footer_columns">
      <div class="site-footer__column site-footer__column--social">
        <ul class="social-media-list">

  
  <li class="social-media-list__item">
    <a title="Twitter Profile" target="_blank" href="https://twitter.com/leahayes"><span class="icon icon--twitter"><svg class="svg-icon" xmlns="http://www.w3.org/2000/svg"><use xlink:href="/assets/icons.svg#twitter"></use></svg></span><span class="username">leahayes</span></a>
  </li>
  

  
  <li class="social-media-list__item">
    <a title="Github Profile" target="_blank" href="https://github.com/rotorz"><span class="icon icon--github"><svg class="svg-icon" xmlns="http://www.w3.org/2000/svg"><use xlink:href="/assets/icons.svg#github"></use></svg></span><span class="username">rotorz</span></a>
  </li>
  

  
  <li class="social-media-list__item">
    <a title="LinkedIn Profile" target="_blank" href="https://www.linkedin.com/in/lea-hayes"><span class="icon icon--linkedin"><svg class="svg-icon" xmlns="http://www.w3.org/2000/svg"><use xlink:href="/assets/icons.svg#linkedin"></use></svg></span><span class="username">lea-hayes</span></a>
  </li>
  

</ul>

      </div>

      <div class="site-footer__column site-footer__column--description">
        <p>Welcome to my personal domain where you can find my blog and take a look at some of the projects that I&#39;ve worked on.</p>
      </div>
    </div>

    <small class="site-footer__copyright">©2009-2020 Lea Hayes. All rights reserved.</small>
  </div>
</footer>



    <script src="/assets/js/gallery.js"></script>
  </body>
</html>
